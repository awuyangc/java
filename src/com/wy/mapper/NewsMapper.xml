<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.wy.dao.NewsMapper">
  <resultMap id="BaseResultMap" type="com.wy.model.News">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue May 12 11:48:50 CST 2015.
    -->
    <id column="news_id" jdbcType="INTEGER" property="newsId" />
    <result column="news_title" jdbcType="VARCHAR" property="newsTitle" />
    <result column="user_id" jdbcType="VARCHAR" property="userId" />
    <result column="create_time" jdbcType="TIMESTAMP" property="createTime" />
    <result column="type_id" jdbcType="INTEGER" property="typeId" />
    <result column="publish" jdbcType="INTEGER" property="publish" />
    <result column="isdelete" jdbcType="INTEGER" property="isdelete" />
    <result column="istop" jdbcType="INTEGER" property="istop" />
    <result column="news_content" jdbcType="LONGVARCHAR" property="newsContent" />
    <association property="newsType" javaType="com.wy.model.NewsType">
      <id property="typeId" column="type_id"/>
      <result property="typeName" column="type_name"/>
    </association>
  </resultMap>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue May 12 11:48:50 CST 2015.
    -->
    delete from t_news
    where news_id = #{newsId,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.wy.model.News" useGeneratedKeys="true" keyProperty="newsId">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue May 12 11:48:50 CST 2015.
    -->
    insert into t_news (news_id, news_title, user_id, 
      create_time, type_id, publish, 
      news_content)
    values (#{newsId,jdbcType=INTEGER}, #{newsTitle,jdbcType=VARCHAR}, #{userId,jdbcType=VARCHAR}, 
      #{createTime,jdbcType=TIMESTAMP}, #{typeId,jdbcType=INTEGER}, #{publish,jdbcType=INTEGER},
      #{newsContent,jdbcType=LONGVARCHAR})
  </insert>
  <update id="updateByPrimaryKey" parameterType="com.wy.model.News">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue May 12 11:48:50 CST 2015.
    -->
    update t_news
    set news_title = #{newsTitle,jdbcType=VARCHAR},
      user_id = #{userId,jdbcType=VARCHAR},
      type_id = #{typeId,jdbcType=INTEGER},
      news_content = #{newsContent,jdbcType=LONGVARCHAR}
    where news_id = #{newsId,jdbcType=INTEGER}
  </update>
  <update id="updatePublish" parameterType="com.wy.model.News">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue May 12 11:48:50 CST 2015.
    -->
    update t_news
    set publish = #{publish,jdbcType=INTEGER} where news_id = #{newsId,jdbcType=INTEGER}
  </update>
  <update id="updateTop" parameterType="com.wy.model.News">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue May 12 11:48:50 CST 2015.
    -->
    update t_news
    set istop = #{istop,jdbcType=INTEGER} where news_id = #{newsId,jdbcType=INTEGER}
  </update>
    <update id="updateDelete" parameterType="com.wy.model.News">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue May 12 11:48:50 CST 2015.
    -->
    update t_news
    set isdelete = #{isdelete,jdbcType=INTEGER} where news_id = #{newsId,jdbcType=INTEGER}
  </update>
  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue May 12 11:48:50 CST 2015.
    -->
    select news_id, news_title, user_id, create_time, type_id, publish, isdelete, istop,news_content
    from t_news
    where news_id = #{newsId,jdbcType=INTEGER}
  </select>
  <select id="selectAll" parameterType="map" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue May 12 11:48:50 CST 2015.
    -->
    select news_id, news_title, user_id, create_time, t_news.type_id,t_news_type.type_name, publish, isdelete,istop
    from t_news join t_news_type on t_news.type_id=t_news_type.type_id
    <where>
    		isdelete=0
			<if test="typeId != null and typeId != ''">
				and t_news.type_id=#{typeId,jdbcType=INTEGER}
			</if>
			<if test="typeName != null and typeName != ''">
				and t_news_type.type_name=#{typeName}
			</if>
			<if test="searchText != null and searchText != ''">
				and (t_news.news_title like '%${searchText}%' or t_news.news_content like '%${searchText}%')
			</if>
	</where>
	 order by istop desc,create_time desc
	 <if test="startIndex != null and startIndex != ''and endIndex != null and endIndex != ''">  
               limit ${startIndex},${endIndex}                    
     </if>
  </select>
  <select id="selectTotal" parameterType="map" resultType="java.lang.Integer">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue May 12 11:48:50 CST 2015.
    -->
    select count(*) from t_news join t_news_type on t_news.type_id=t_news_type.type_id
    <where>
    		isdelete=0
			<if test="typeId != null and typeId != ''">
				and t_news.type_id=#{typeId,jdbcType=INTEGER}
			</if>
			<if test="typeName != null and typeName != ''">
				and t_news_type.type_name=#{typeName,jdbcType=INTEGER}
			</if>
			<if test="searchText != null and searchText != ''">
				and (t_news.news_title like '%${searchText}%' or t_news.news_content like '%${searchText}%')
			</if>
	</where>
  </select>
  
    <select id="selectAllByType" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue May 12 11:48:50 CST 2015.
    -->
    select news_id, news_title, user_id, create_time, t_news.type_id,t_news_type.type_name, publish, isdelete,istop, news_content
    from t_news join t_news_type on t_news.type_id=t_news_type.type_id where isdelete=0 and t_news.type_id=#{news.typeId,jdbcType=INTEGER}
  </select>
  
  
</mapper>